# 要件とテストのトレーサビリティ - チケット管理アプリ

- 文書ID：RTT-TICKET-001
- 版：v0.4
- ステータス：Draft
- 最終更新日：2026-01-20
- 作成者：仁後慎太郎
- 対象：チケット管理アプリ（Web, Django + SQLite）
- 関連：
  - 要件：`../requirements/requirements.csv`（RQ-001～）
  - テスト条件：`../docs/20_test_conditions.md`（TCND-001〜）
  - テストケース：`../testcases/testcases.csv`（TC-001〜）
  - テスト計画：`../docs/10_test_plan.md`（R-01〜）
  - テスト結果：`../results/test_results.csv`（TR-0001～）
  - 欠陥ログ：`../defects/defect_log.csv`（DEFECT-001～）

---

## 1. 目的

本ドキュメントは、「要件（RQ）→ テスト条件（TCND）→ テストケース（TC）」の対応関係を明示し、
要件カバレッジ（未カバー/一部/カバー）と残存課題（追加・スコープ外・要件修正）を可視化する。

---

## 2. 管理対象と前提（重複排除の方針）

### 2.1 本書で管理するもの（一次ソース）
- **RQ → TCND → TC** の対応（要件カバレッジ判断に直結）

### 2.2 本書で管理しないもの（参照に留める）
- **TCND（定義本文）**  
  → `20_test_conditions.md` を正とする（本書では重複を避ける）
- **TCND → TC の“全量一覧”**  
  → `../testcases/testcases.csv` を正とする（本書では重複を避ける）  
  → ただし **未カバー/一部/要件外（RQなし）** のみ本書に抜粋して課題管理する
- **リスク（R-XX）トレーサビリティ**  
  → テスト計画側（`10_test_plan.md`）で管理（本書は要件カバレッジ中心）

---

## 3. ID体系（採番）

- 要件ID：`RQ-XXX`（例：RQ-015）
- テスト条件ID：`TCND-XXX`（例：TCND-002）
- テストケースID：`TC-XXX`（例：TC-003）
- リスクID：`R-XX`（例：R-01）
- テスト結果ID：`TR-XXXX`（例：TR-0002）
- 欠陥ID：`DEFECT-XXX`（例：DEFECT-001）

---

## 4. カバレッジ定義

- **カバー**：対応するTCNDが定義され、かつ該当TCが存在する
- **一部**：一部TCは存在するが、要件の全受入条件（粒度/例外/ロール等）が未検証、またはTCND/TCが不足
- **未カバー**：対応するTCNDまたはTCが未定義（＝現時点で検証できていない）

---

## 5. トレーサビリティ（RQ → TCND → TC）

> 注：本表の「関連TC」は参照情報であり、一次ソースは `../testcases/testcases.csv` とする。

| 要件ID | 要件 | 優先度 | 関連TCND | 関連TC | カバレッジ | 備考 |
|---|---|---|---|---|---|---|
| RQ-001 | ログイン必須 | Must | TCND-029 | TC-042;TC-043;TC-044 | カバー | 未ログイン時の一覧/詳細/作成を対象に確認する。 |
| RQ-002 | 全操作は監査ログに残る | Must | TCND-043 | TC-018 | 一部 | 主要操作（作成/割当/変更/コメント）で確認。全操作網羅は未確定。 |
| RQ-003 | チケットのtitleは必須かつ最大80文字 | Must | TCND-013;TCND-014;TCND-015 | TC-032;TC-033;TC-034;TC-035 | カバー |  |
| RQ-004 | チケットのbodyは必須かつ最大4000文字 | Must | TCND-013 | TC-032 | 一部 | 本文の境界値（最大長ちょうど/超過）のTCが未作成。 |
| RQ-005 | statusは必須で初期値Open | Must | TCND-013 | TC-032 | 一部 | 初期値Openの明示確認／不正ステータス拒否の明示TCが未整備。 |
| RQ-006 | due_dateは任意で過去日不可 | Must | TCND-017 | TC-036 | カバー |  |
| RQ-007 | assigneeは任意でAdminのみ設定/変更できる | Must | TCND-005 | TC-009 | カバー |  |
| RQ-008 | 添付は任意で1ファイルのみ | Must | TCND-018 | TC-038 | 一部 | 複数添付不可（1ファイルのみ）の異常系TCが未作成。 |
| RQ-009 | 添付は拡張子制限がある | Must | TCND-019 | TC-039 | カバー |  |
| RQ-010 | 添付はサイズ上限5MB | Must | TCND-018 | TC-038 | カバー |  |
| RQ-011 | 添付は作成時のみ付与でき、差し替え/削除は不可 | Must | TCND-032 | TC-037 | カバー | UI不存在/拒否を確認。 |
| RQ-012 | Requesterは自分名義でチケット作成できる | Must | TCND-013 | TC-032 | カバー |  |
| RQ-013 | Agentはチケットを作成できない | Must | TCND-033 | TC-016;TC-017 | カバー |  |
| RQ-014 | Adminはチケットを作成できる | Should | - | - | 未カバー | 運用方針により追加 or 対象外化。 |
| RQ-015 | Requesterは自分のチケットのみ閲覧できる | Must | TCND-001;TCND-002;TCND-020 | TC-001;TC-002;TC-003;TC-012 | カバー |  |
| RQ-016 | Agentは全チケットを閲覧できる | Must | TCND-004 | TC-011 | カバー |  |
| RQ-017 | Adminは全チケットを閲覧できる | Must | TCND-035 | TC-013 | カバー |  |
| RQ-018 | 検索（q）でtitle/body部分一致ができる | Must | TCND-021 | TC-040 | カバー |  |
| RQ-019 | 状態フィルタでstatus絞り込みができる | Must | TCND-022 | TC-041 | カバー |  |
| RQ-020 | 詳細画面に主要項目を表示する | Must | TCND-036 | TC-006 | カバー |  |
| RQ-021 | Requesterは自分のチケットにコメント追加できる | Must | TCND-024 | TC-015 | カバー |  |
| RQ-022 | Requesterは他人のチケットにコメントできない | Must | TCND-037 | TC-014 | カバー | UI/直叩きいずれでも拒否されること。 |
| RQ-023 | Agentは任意のチケットにコメント追加できる | Must | TCND-024 | TC-015 | カバー |  |
| RQ-024 | Adminは任意のチケットにコメント追加できる | Must | - | - | 未カバー | Adminでのコメント追加を確認するTCが未作成。 |
| RQ-025 | コメント追加は監査ログに記録される | Must | TCND-043 | TC-018 | カバー |  |
| RQ-026 | Requesterはステータス変更できない | Must | TCND-003 | TC-004;TC-005 | カバー |  |
| RQ-027 | Requesterは担当者割当できない | Must | - | - | 未カバー | Requesterによる割当操作拒否の明示TCは未整備。 |
| RQ-028 | Requesterは期限変更できない | Must | - | - | 未カバー | 更新UI/直叩き拒否を確認するTC未作成。 |
| RQ-029 | Agentは担当チケットのみ更新できる | Must | TCND-040 | TC-007 | 一部 | 非担当の「ステータス変更」拒否は確認。 |
| RQ-030 | Agentは担当者割当できない | Must | TCND-005 | TC-010 | カバー |  |
| RQ-031 | Agentは期限変更できない | Should | - | - | 未カバー |  |
| RQ-032 | Adminは全チケットを更新できる | Must | - | - | 未カバー |  |
| RQ-033 | Adminは未割当チケットをAgentへ割当できる | Must | TCND-005 | TC-009 | カバー |  |
| RQ-034 | 担当未割当チケットはAgentが操作できない | Must | TCND-041 | TC-008 | カバー |  |
| RQ-035 | 許可された遷移のみ可能 | Must | TCND-006〜010 | TC-019〜TC-031 | カバー | 全遷移パターンの網羅。 |
| RQ-036 | Open→In Progress / Pending が可能 | Must | TCND-006 | TC-021;TC-030 | カバー |  |
| RQ-037 | In Progress→Resolved / Pending が可能 | Must | TCND-007 | TC-022;TC-025 | カバー |  |
| RQ-038 | Pending→In Progress が可能 | Must | TCND-008 | TC-023 | カバー |  |
| RQ-039 | Resolved→Closed が可能 | Must | TCND-009 | TC-027 | カバー |  |
| RQ-040 | Open→Closed は禁止 | Must | TCND-010 | TC-020 | カバー |  |
| RQ-041 | Closedからの遷移はすべて禁止 | Must | TCND-010 | TC-028 | カバー |  |
| RQ-042 | 監査ログ一覧を閲覧できる | Should | TCND-030 | TC-018 | カバー |  |

---

## 6. カバレッジ集計

要件（全42件）に対し、現行のテスト条件/テストケースでのカバレッジは以下。

- カバー：30件
- 一部カバー：7件
- 未カバー：5件

- 未カバー要件：RQ-014;RQ-024;RQ-028;RQ-031;RQ-032
- 一部カバー要件：RQ-002;RQ-004;RQ-005;RQ-006;RQ-008;RQ-027;RQ-029

---

## 7. 未カバー/一部カバーの扱い（分類ルール）

未カバー/一部カバーは、以下のいずれかに必ず分類して扱う。

- **A. 追加してカバー**（Must要件、リスク優先）
- **B. スコープ外として明記**（MVP外、将来機能、工数都合など）
- **C. 要件を修正・明確化**（ロール/運用/実装/TCの不一致）

### 主要論点（優先的に整理）
- `RQ-006（due_dateのロール前提）` と現行TC前提が不一致  
  → **「作成時にRequesterが入力可」か「Adminのみ」か**を決め、要件/実装/TCを揃える（C）
- `RQ-002（監査ログ：全操作）` は範囲定義が曖昧  
  → “全操作”の定義（操作一覧）を確定し、不足分を追加（C→A）
- `RQ-029（Agentは担当のみ更新）` の「更新」の定義が曖昧  
  → コメント等を更新に含めるかを確定し、非担当時の期待挙動を固定（C→A）

---

## 8. Backlog（未カバー/一部の解消候補）

| 要件ID | 状態 | 方針 | 追加/整理内容 | 既存ID | 次アクション案 |
| --- | --- | --- | --- | --- | --- |
| RQ-014 | 未カバー | B or A | Admin作成をスコープ内にするか決める | TCND-034 | 方針決定→対象ならTC追加 |
| RQ-024 | 未カバー | A | Adminが任意チケットへコメント追加 | TCND-038 | TC作成（UI/直叩き方針も決める） |
| RQ-028 | 未カバー | A | Requester期限変更不可（UI/直叩き拒否） | TCND-039 | TC作成 |
| RQ-032 | 未カバー | A | Admin更新権限（status/assignee/due_date等） | TCND-042 | TC作成（更新項目の範囲定義） |
| RQ-031 | 未カバー | B or A | Agent期限変更不可（Should扱い） | - | 運用方針で対象外化 or 追加 |
| RQ-004 | 一部 | A | 本文境界値（4000ちょうど/超過） | TCND-016 | TC追加 |
| RQ-005 | 一部 | A | status初期値Openの明示確認／不正値拒否（列挙制約） | TCND-044（再定義） | 20にTCND追加→TC作成 |
| RQ-008 | 一部 | A | 複数添付拒否（1ファイルのみ） | TCND-031 | TC追加 |
| RQ-006 | 一部 | C | due_dateの入力主体（Requester/Admin）整合 | TCND-017 | 要件修正 or TC修正 |
| RQ-027 | 一部 | A | Requester視点の割当拒否（UI/直叩き） | TCND-005 | TC追加 |
| RQ-002 | 一部 | C→A | “全操作”の範囲定義→不足操作の追加 | TCND-043 | 操作一覧化→不足TC追加 |
| RQ-029 | 一部 | C→A | “更新”の定義確定（コメント等）→非担当拒否 | TCND-040 | 要件固定→不足TC追加 |

---

## 9. 注意

### RQが空のテストケースの扱い
一部のテストケース（例：同時更新/二重操作/整合性など）は、要件CSV（RQ-001〜RQ-042）に明文化されていない品質リスクに基づくリスクベーステストとして定義している。  
これらは「要件カバレッジ」には算入しないが、残存リスク評価の根拠としてテスト結果および完了レポートで扱う。

### TCND→TCの一覧について
TCND→TCの全量一覧は `../testcases/testcases.csv` を正とし、本書では重複を避けて掲載しない。
未カバー/一部/要件外（RQなし）だけを Backlog として本書で追跡する。

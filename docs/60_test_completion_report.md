# テスト完了レポート - チケット管理アプリ

- 文書ID：TCR-TICKET-001
- 版：v0.4
- ステータス：Draft
- 最終更新日：2026-02-13
- 作成者：仁後慎太郎
- 対象：チケット管理アプリ（Web, Django + SQLite）
- 関連：
  - テスト計画：`../docs/10_test_plan.md`
  - テスト条件：`../docs/20_test_conditions.md`
  - 要件とテストのトレーサビリティ：`../docs/70_requirements_test_traceability.md`
  - テストケース：`../testcases/testcases.csv`
  - テスト結果：`../results/test_results.csv`
  - 欠陥ログ：`../defects/defect_log.csv`

---

## 1. サマリ

本レポートは、テスト実行の結果概要（定量/定性）と、残存リスク・今後の課題をまとめる。

- 対象期間：2026-01-13 〜 2026-02-12
- 実行環境：Win11 / Chrome（`test_results.csv` の実行環境列を正とする）
- 実行ビルド：
  - `app-defect-idor`（意図的欠陥の再現）
  - `app-v0.3`
  - `app-v0.3.1`（マイナーアップデート）

結論：現行テストセット（TC-001〜TC-044）の実行が完了し、重大欠陥（Critical/High）の未解決はゼロである。一方で、要件カバレッジ上の未カバー/一部カバー要件が残っており、Backlogとして整理済み（70参照）。

---

## 2. 実施範囲

### 2.1 実施した主要領域
- 権限・認可（参照/更新、直接アクセス/直接操作の拒否を含む）
- 状態遷移（許可遷移・禁止遷移、禁止遷移の拒否）
- 入力検証（必須、境界値、添付制約、期限）
- 一覧・検索・フィルタ
- 履歴/監査ログ（表示、操作種別の識別）

### 2.2 非対象（本レポートでは扱わない）
- 負荷・性能（定量的な性能評価）
- 専門的な脆弱性診断（侵入テスト等）
- CI/CD 自動実行（将来拡張）

---

## 3. 結果概要（定量）

`../results/test_results.csv` からの集計（TR-0001〜TR-0046）。

- 実行件数：46
- 合格（Pass）：44
- 不合格（Fail）：2
- 実行不可（Blocked）：0

補足：
- 不合格2件（TR-0001/TR-0002）は **意図的欠陥ビルド（app-defect-idor）** における再現結果。
- 同一観点は回帰で合格確認済み（TR-0003/TR-0004、`app-v0.3`）。

---

## 4. 終了基準の達成状況

テスト計画書（`10_test_plan.md`）の終了基準に沿って、以下を確認した。

### (1) 実行完了（現行テストセット）
- [x] 現行テストセット（TC-001〜TC-044）の実行が完了している（結果が `test_results.csv` に記録済み）
- [x] 証跡（スクショ等）が記録され、TRから追跡できる（`test_results.csv` の証跡列）

### (2) 最優先リスク（R-01〜R-02）の評価完了
- [x] **R-01（認可/IDOR）**の代表ケースを実行済み  
  （例：**TC-001/TC-002/TC-003/TC-010/TC-012/TC-014/TC-007/TC-008**）
- [x] **R-02（状態遷移/制約）**の代表ケースを実行済み  
  - 許可遷移（例：**TC-021/TC-022/TC-023/TC-025/TC-027/TC-030**）  
  - 禁止遷移（例：**TC-019/TC-020/TC-024/TC-026/TC-028/TC-031**）  
  - 直接操作での禁止遷移（例：**TC-029**）


### (3) 欠陥の収束（重大欠陥）
- [x] 未解決の重大欠陥（Critical/High）がゼロ  
  - DEFECT-001 は「検証済」（修正確認まで完了）

### (4) 要件カバレッジの説明責任（未カバーを根拠付きで扱う）
- [x] `70_requirements_test_traceability.md` にて、未カバー/一部カバーを A/B/C で分類している
- [x] Must/Should の扱い（採用/スコープ外/要件明確化）がBacklogで追跡できる

### (5) 完了レポートへの明示
- [x] 本レポートに実行結果サマリ／欠陥状況／残存リスク（Backlog含む）を記載した

---

## 5. 要件カバレッジ（70の集計に基づく）

`../docs/70_requirements_test_traceability.md` の集計（全42件）。

- カバー：30件
- 一部カバー：7件
- 未カバー：5件

### Must / Should の内訳
- Must：39件（カバー29 / 一部7 / 未カバー3）
- Should：3件（カバー1 / 一部0 / 未カバー2）

未カバー要件（70より）：
- Must：RQ-024, RQ-028, RQ-032
- Should：RQ-014, RQ-031

一部カバー要件（70より）：
- RQ-002; RQ-004; RQ-005; RQ-006; RQ-008; RQ-027; RQ-029

---

## 6. 主要な欠陥と状況（定性）

欠陥ログ（`../defects/defect_log.csv`）を参照。

- DEFECT-001：依頼者が他人チケット詳細を参照できる（Severity：Critical / Priority：High）  
  - 状況：意図的欠陥ビルドで再現（TR-0001/TR-0002）→ 修正後ビルドで回帰合格（TR-0003/TR-0004）→ 欠陥状態：検証済

---

## 7. 残存リスク / 未完了事項（Backlogの扱い）

本リリースでは、未カバー/一部カバー要件をゼロにすることは終了条件に含めていない。
代わりに、70のBacklog（A/B/C分類）として「根拠を残して追跡」している。

### 7.1 未カバー要件
| 要件ID | 状態 | 方針 | 追加/整理内容 | 既存ID | 次アクション案 |
| --- | --- | --- | --- | --- | --- |
| RQ-014 | 未カバー | B or A | Admin作成をスコープ内にするか決める | TCND-034 | 方針決定→対象ならTC追加 |
| RQ-024 | 未カバー | A | Adminが任意チケットへコメント追加 | TCND-038 | TC作成（UI/直叩き方針も決める） |
| RQ-028 | 未カバー | A | Requester期限変更不可（UI/直叩き拒否） | TCND-039 | TC作成 |
| RQ-032 | 未カバー | A | Admin更新権限（status/assignee/due_date等） | TCND-042 | TC作成（更新項目の範囲定義） |
| RQ-031 | 未カバー | B or A | Agent期限変更不可（Should扱い） | - | 運用方針で対象外化 or 追加 |

### 7.2 一部カバー要件
| 要件ID | 状態 | 方針 | 追加/整理内容 | 既存ID | 次アクション案 |
| --- | --- | --- | --- | --- | --- |
| RQ-004 | 一部 | A | 本文境界値（4000ちょうど/超過） | TCND-016 | TC追加 |
| RQ-005 | 一部 | A | status初期値Openの明示確認／不正値拒否（列挙制約） | TCND-044（再定義） | 20にTCND追加→TC作成 |
| RQ-008 | 一部 | A | 複数添付拒否（1ファイルのみ） | TCND-031 | TC追加 |
| RQ-006 | 一部 | C | due_dateの入力主体（Requester/Admin）整合 | TCND-017 | 要件修正 or TC修正 |
| RQ-027 | 一部 | A | Requester視点の割当拒否（UI/直叩き） | TCND-005 | TC追加 |
| RQ-002 | 一部 | C→A | “全操作”の範囲定義→不足操作の追加 | TCND-043 | 操作一覧化→不足TC追加 |
| RQ-029 | 一部 | C→A | “更新”の定義確定（コメント等）→非担当拒否 | TCND-040 | 要件固定→不足TC追加 |

---

## 8. バージョンまたぎ実行の説明

今回の実行は `app-v0.3` と `app-v0.3.1` を跨いで実施した。
理由は、`v0.3.1` が **セキュリティ関連のマイナーアップデート**であり、要件・期待結果に影響する機能仕様変更がない前提で、テスト実行を継続したため。

運用ルール（今回の整理）：
- テスト結果は `test_results.csv` の build 列で追跡可能であるため、跨ぎ実行を許容する
- 仕様影響が疑われる変更が入った場合は、影響範囲の代表ケースを回帰として追加実行する

---

## 9. 得られた教訓

- 認可や禁止遷移は、UI上の制御だけでなく **サーバ側（直接操作）** で拒否されることを確認すると説得力が上がる
- 要件カバレッジを「未カバー＝悪」とせず、A/B/C分類で **説明可能な状態** にしておくと、完了判定と改善活動が両立できる
- テスト結果（TR）と欠陥ログ（DEFECT）を分離すると、再現→修正→回帰の流れが追跡しやすい

---

## 10. 次のアクション（優先順）

- [ ] 70のBacklog（A/B/C）を更新し、未カバー/一部カバーの解消方針を確定する
- [ ] （A群）必要に応じてTC追加（RQ-024/RQ-028/RQ-032/RQ-005/RQ-008 など）
- [ ] （C群）要件と実装/TCの不一致を解消（RQ-006, RQ-029, RQ-002）

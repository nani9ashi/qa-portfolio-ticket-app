# テスト完了レポート - チケット管理アプリ

- 文書ID：TCR-TICKET-001
- 版：v0.3
- ステータス：Draft
- 最終更新日：2026-02-13
- 作成者：仁後慎太郎
- 対象：チケット管理アプリ（Web, Django + SQLite）
- 関連：
  - テスト計画：`../docs/10_test_plan.md`
  - テスト条件：`../docs/20_test_conditions.md`
  - テストケース：`../testcases/testcases.csv`
  - テスト結果：`../results/test_results.csv`
  - 欠陥ログ：`../defects/defect_log.csv`
  - 要件とテストのトレーサビリティ：`../docs/70_requirements_test_traceability.md`

---

## 1. サマリ

本レポートは、テスト実行の結果概要、終了基準の達成状況、残存リスク、得られた教訓をまとめる。

- 対象：チケット管理アプリ（Web）
- 対象期間：2026-01-13 〜 2026-02-12（`../results/test_results.csv` より）
- 実行環境：Win11 / Chrome（記録ベース）
- 実行結果（最終判定）：**完了（Pass）**
  - 初回実行で Fail となったケース（TC-002/TC-003）は、修正後の回帰で Pass を確認

---

## 2. 実施範囲

### 2.1 実施した主要領域
- 認証/認可（未ログイン制御、他人チケット参照禁止、直接操作の拒否）
- 権限制御（ロール別の参照/更新/作成、担当制約、未割当制約）
- 状態遷移（許可遷移・禁止遷移、直接操作での拒否）
- 入力検証（必須、境界値、期限、添付のサイズ/形式）
- 一覧・検索・フィルタ
- 監査ログ/履歴（操作種別、actor、時刻の追跡）

### 2.2 対象外（今回の完了レポートでは扱わない）
- 負荷/性能の定量評価
- 専門的な脆弱性診断（侵入テスト等）
- 自動化（CI上でのE2E/ユニットの継続実行）

---

## 3. 実行結果（定量）

### 3.1 実行サマリ
`../results/test_results.csv` の記録に基づく。

| 指標 | 値 |
| --- | ---: |
| テスト実行回数（TR行数） | 46 |
| 実行テストケース数（ユニークTC） | 44（TC-001〜TC-044） |
| 合格（Pass） | 44 |
| 不合格（Fail） | 2 |
| 実行不可（Blocked） | 0 |
| 合格率（実行回数ベース） | 95.7%（44/46） |

※Fail 2件は意図的欠陥（IDOR=ON）で再現したもので、修正後の回帰（TR-0003/0004）で合格を確認。

### 3.2 テスト種別（新規/回帰）
| 種別 | 回数 |
| --- | ---: |
| 新規 | 44 |
| 回帰 | 2 |

### 3.3 ビルド別の実行状況
| ビルド | 回数 | 備考 |
| --- | ---: | --- |
| app-defect-idor | 2 | 意図的欠陥の再現（Fail） |
| app-v0.3 | 15 | 新規中心 |
| app-v0.3.1 | 29 | 新規中心（後半の実行） |

---

## 4. 終了基準の達成状況（テスト計画 7.2 への回答）

テスト計画書（`../docs/10_test_plan.md`）の終了基準に対する実績は以下。

| 終了基準（TP 7.2） | 判定 | 根拠 |
| --- | --- | --- |
| 優先度「最優先」リスク（R-01〜R-02）に対する必須ケースの実行が完了 | ✅達成 | 主要な認可/遷移を含む TC-001〜TC-044 の実行記録（`test_results.csv`） |
| 未解決の重大欠陥（Severity：Critical/High）がゼロ、または回避策・受容の合意がある | ✅達成 | 欠陥は DEFECT-001（Critical）のみ。ステータス「検証済」（`defect_log.csv`） |
| テスト完了レポートに、実行結果と残存リスクが記載されている | ✅達成 | 本書（セクション5/6/7） |

---

## 5. 主要な欠陥と状況（定性）

欠陥ログ（`../defects/defect_log.csv`）を参照。影響が大きいものを抜粋する。

- **DEFECT-001：依頼者が他人チケット詳細を参照できる**
  - 重要度：Critical / 優先度：High
  - 検出：2026-01-13（TR-0001/TR-0002）
  - 状況：検証済（修正後に回帰で合格：TR-0003/TR-0004）
  - 備考：意図的欠陥（IDOR=ON）を再現して検出・修正確認までを記録

---

## 6. バージョンまたぎでテストした件の説明（運用上の判断）

今回、`app-v0.3` と `app-v0.3.1` をまたいでテスト結果を集計している。

- `v0.3.1` は **セキュリティ関連のマイナーアップデート**（機能仕様の変更を伴わない想定）として扱い、
  テストの集計は「同一スコープのSUT」として一括で管理した。
- ただし、**ビルド差分の追跡可能性**を残すため、`test_results.csv` には各TRにビルド名を記録している。
- 次回以降、機能差分がある場合は「差分影響範囲に絞った回帰セット」を明示し、ビルドごとに完了判定を分ける。

---

## 7. 残存リスク（未カバー/一部カバー）

要件カバレッジは `../docs/70_requirements_test_traceability.md` を一次ソースとして扱う。

- 未カバー要件（例）：RQ-014 / RQ-024 / RQ-028 / RQ-031 / RQ-032
- 一部カバー要件（例）：RQ-002 / RQ-004 / RQ-005 / RQ-006 / RQ-008 / RQ-027 / RQ-029

残存リスクの代表例：
- **Should要件（RQ-014/RQ-031/RQ-042等）の採否**が運用方針に依存しており、MVPの完了判定に含めない場合は「スコープ外」として明記が必要
- **“全操作が監査ログに残る”の操作範囲定義（RQ-002）**が曖昧な場合、網羅性評価が不確実になりうる

---

## 8. 得られた教訓

- 認可や状態遷移は **UI上の抑止だけでなく、サーバ側の拒否**（直接操作）まで確認して初めて担保できる
- 実行記録（TR）と欠陥ログ（DEFECT）を分離し、証跡を参照リンク化すると、運用が継続しやすい
- 意図的欠陥（例：IDOR）を使うと、**「検出→修正→回帰」の一連**をポートフォリオとして示しやすい

---

## 9. 次のアクション（必要に応じて）

- [ ] **ID採番変更後の整合確認**：`testcases.csv` と `70_requirements_test_traceability.md` の関連TC（TC-XXX）が最新採番と一致するか点検
- [ ] Should要件の扱い（採用/スコープ外）を 70 の Backlog 分類に確定反映
- [ ] 回帰テストの「最小セット」（権限/遷移/監査ログ）を明文化（将来CI導入時にそのまま流用）
